<document>
	<date>2012-04-25</date>
        <title>
Visionner ses camras dans MCE</title>
        <author>Cdric Locqueneux</author>
        <tags_set>
                <tag>MCE</tag>
                <tag>videosurveillance</tag>
        </tags_set>
        <categories_set>
                <category>Guides Securite</category>
        </categories_set>
        <text>Suite a l article presentant mon installation de video surveillance , vous avez ete nombreux a me demander comment je faisais pour afficher mes cameras dans Windows Media Center. Ce nest pas tres difficile, mais je vais vous expliquer comment faire.   
 I. Pre requis  Ce tuto fonctionne sur Windows 7 avec Media Center. Je nai pas teste sur les anciennes versions. Quant aux cameras, il faudra des cameras qui permettent laffichage dimages en appelant une simple URL, comme par exemple les cameras Foscam. Chez moi jutilise les  cameras Tenvis  ou les  cameras domes  presentees recemment sans aucun soucis. Lurl est dans ce cas de ce type pour afficher une image: http://IP_CAMERA/snapshot.cgi?user=USERpwd=PASSWORD  Il faudra ensuite  telecharger ces fichiers ici . Vous aurez alors: mycameras.mcl necessaire pour etre reconnu par MCE mycameras.html qui se chargera dafficher les images des cameras mycameras.png qui est une icone illustrant le menu dans MCE 
 II. Installation  Il faudra commencer par modifier le fichiermycameras.html afin de renseigner les adresses IP des cameras, ainsi que les utilisateurs et mot de passe:   Il sagit dun fichier html tout ce quil y a de plus classique. Il est configure ici pour afficher quatre cameras, mais on peut en mettre plus ou moins. Il est egalement possible dajuster la taille de limage: jai mis ici une taille assez petite, car ma TV nest pas HD et dispose dune petite resolution, donc si je voulais voir les quatre cameras dun coup sans avoir a faire defiler la page, il fallait que je reduise Certains se poseront sans doute la question: pourquoi utiliser dans lurl snapshot, qui donne une image fixe, et pas videostream qui donne acces au flux video en temps reel ? Et bien MCE utilise Internet Explorer pour afficher la page html, et lutilisation de videostream genere un telechargement sans fin au lieu dafficher limage :( Pour resoudre ce probleme, on utilise donc snapshot, qui affiche une image fixe, et on rafraichit automatiquement la page html toutes les 5s (duree qui peut etre ajustee egalement dans le haut du fichier html). Cest moins fluide, mais ca a le merite de fonctionner. Une fois ce fichier complete correctement, il va falloir placer les trois fichiers au bon endroit. Pour cela il faut se rendre dans le repertoireC:/ProgramData/Microsoft/Windows/Start Menu/Programs/Accessories/Media Center/Media Center Programs Attention: le repertoire ProgramData est un dossier cache, par defaut il est possible que les repertoiresMedia Center/Media Center Programs nexistent pas chez vous. Pas de panique, il suffit de les creer manuellement.  Voila, il ny a plus qua demarrer MCE. Dans le menu Bonus, vous devriez avoir une nouvelle icone Cameras:   En la selectionnant, on accede a la visualisation des cameras:   Et tout ca a la telecommande, sur sa TV :D Bien sur, vous pouvez personnaliser a votre convenance: icone du menu, polices, couleur de fond, taille des images, etc Comme je le disais ca reste du html, rien de tres complique. Maintenant vous avez lastuce pour ajouter des elements dans Media Center. Vu que ce nest quune page html, cela ne vous donne pas des idees ??   MCE   videosurveillance 
        </text>
</document>
