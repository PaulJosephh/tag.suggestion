<document>
	<date>2011-07-27</date>
        <title>
Passer son Hackintosh  Lion</title>
        <author>Cdric Locqueneux</author>
        <tags_set>
                <tag>Hackintosh</tag>
                <tag>Lion</tag>
        </tags_set>
        <categories_set>
                <category>Guides Informatiques</category>
        </categories_set>
        <text>Lion, le dernier OS dApple pour Mac  est sorti la semaine derniere. Comme tout bon geek / Apple fan (rayez la mention inutile :p), il a bien sur fallu que je teste ce nouveau systeme, en loccurrence sur mon  Hackintosh , car je nai pas encore la chance detre equipe dun vrai Mac (ca viendra). La difficulte pour passer mon Hackintosh sous Lion a ete le fait quetant tres recent, il est encore tres difficile de trouver un guide complet, et qui fonctionne. Du coup je me suis lance dans laventure. Apres de multiples tests et une dizaine de reinstallation de lOS, jai enfin aujourdhui une configuration parfaitement stable sur laquelle je travaille depuis 3 jours. La methode est maintenant rodee, et jinstalle Lion et tout le necessaire en moins de 45 minutes :D Je vous propose donc mon petit guide maison, qui pourra sans doute vous etre utile pour avoir a votre tour un Hackintosh fonctionnel sous Lion !  
 I. Materiel  Jai bien sur repris mon ancienne configuration, a savoir: Carte mere Gigabyte G31M-ES2L (v1) Carte Graphique GeForce 8400GS  512 Mo DDR2  PCI-Express 16X Kit de 2 Barrettes CORSAIR DDR2 PC2-6400  2 x 2 Go 800 MHz Processeur INTEL Core 2 Duo E8400  3.0 GHz Graveur DVD Interne 20X  DVR-216D  SATA 1 Disque dur interne 3.5 Samsung 1To 7200 tr/min Carte FireWire 800 PCI 64 Bits 21394B +11394A: 59  Seul le disque dur a change, car pour ne pas planter completement mon systeme, jai prefere demonter les disques durs ou etait installe Snow Leopard et en utiliser un autre pour faire une installation propre de Lion. 1 To, cest tout ce que javais sous la main a ce moment la  
 II. Prerequis  Pour ce guide, vous aurez besoin: dun Mac (ce peut etre votre Hackintosh sous Snow Leopard, ou le Mac dun ami) de votre hackintosh, de preference respectant la configuration donnee plus haut, car les fichiers de configuration que je vais donner sont specifiques a ce materiel (notamment la carte mere) dune cle Usb dau moins 8Go de  Chameleon 2.0 RC5 de l installateur Extra Lion de l installateur Extra Folder du  fichier OSInstall du  fichier DSDT  correspondant a la carte mereG31M-ES2L (v1) (si jamais celui ci ne fonctionne pas pour vous, vous pouvez generer le votre vous meme  en suivant cette methode ) de  Kext Wizard , et du  pack de Kexts  que jai utilise 
 III. Preinstallation  Tout dabord, il va falloir recuperer Lion, telechargeable sur lAppStore pour 24. La, un premier probleme peut se poser, lAppStore vous disant que Lion ne peut pas etre installe sur cette configuration, et donc ne vous laissant pas lacheter :/ La, je vous laisse faire appel a votre debrouille, ou attendre la sortie au mois daout dune cle Usb contenant Lion, qui devrait etre commercialisee dans les 60. Une fois que vous avez le fichier dinstallation de Lion (qui pese dans les 3.5Go tout de meme), il va falloir en faire une cle Usb dinstallation. Faites un clic droit sur le fichier dinstallation de Lion, puis selectionnez Afficher le contenu du paquet:   Ensuite, allez dans le repertoire Contents/SharedSupport, et copiez collez le fichier InstallESD.dmg sur le bureau. Attention a bien faire un copier coller, et ne pas seulement le faire glisser sur le bureau, ca ne fonctionnera pas.   Double cliquez ensuite dessus pour monter cette image disque. Ensuite, ouvrez une fenetre terminal (dans les outils du Mac), et tapez:  open /Volumes/Mac\ OS\ X\ Install\ ESD/BaseSystem.dmg  Vous devriez maintenant avoir ces trois fichiers:   Allez maintenant dans lutilitaire de disques du Mac, selectionnez votre cle Usb, et demandez a restaurer dessus limageBaseSystem.dmg que la manip precedente a fait apparaitre sur votre bureau. La restauration va prendre quelques minutes, une fois termine votre cle devrait sappeler Mac OS X Base System.   Une fois la restauration terminee, ouvrez votre cle Usb, et rendez vous dans le repertoireSystem/Installation . La, supprimez le raccourci Packages, et creez un nouveau repertoire portant le meme nom.  De nouveau dans la fenetre terminal, tapez  open /Volumes/Mac\ OS\ X\ Install\ ESD/Packages  Une fenetre doit safficher: copiez tout le contenu dans le repertoire Packages cree precedemment.   Dans ce meme repertoire Packages, remplacez le fichier OSInstall par celui telecharge precedemment. Ce fichier permettra de ne pas avoir le message disant que le systeme ne peut etre installe sur cette configuration. Enfin, installez Extra Lion et Chameleon, en faisant attention de bien indiquer la cle Usb comme destination pour linstallation. Cela permettra a la cle Usb de demarrer lordinateur, pour ensuite lancer linstallation.   
 IV. Installation  Nous allons maintenant pouvoir passer a linstallation. Branchez la cle Usb que vous avez creee, et au demarrage, verifiez bien dans le Bios de votre ordinateur que cette cle Usb est en premiere position pour le demarrage. Demarrez ensuite normalement, vous devriez arriver sur cet ecran:   Validez simplement par Enter. Des lignes vont defiler pendant quelques instants, puis vous arriverez sur linterface de linstallation de Lion. Une fois dans linterface dinstallation, le reste est tres classique. Selectionnez la langue francaise, ensuite cliquez sur le drapeau americain en haut a droite pour passer le clavier egalement en francais.   Allez dans le menu outils, gestion des disques durs, et formatez votre disque dur, en Mac etendu (avec journalisation).   Une fois le disque dur formate, revenez sur linterface dinstallation, et poursuivez linstallation en cliquant sur continuer et en selectionnant bien votre disque dur fraichement formate. Il ny a plus qua patienter une vingtaine de minutes, le temps que le systeme sinstalle.   Une fois linstallation terminee, le systeme redemarre tout seul. Laissez bien la cle Usb, car a ce stade, le systeme ne sait toujours pas demarrer seul. Au demarrage, vous aurez un ecran de selection du disque dur: selectionnez le hdd(2,2), qui correspond au 2eme disque dur de votre systeme (le premier disque etant votre cle Usb) et a la partition 2 (la premiere partition etant en fait une partition de restauration de Lion, creee automatiquement).   Votre nouvel OS devrait se lancer, et vous demander quelques derniers petits details, comme votre nom de session, etc Vous voila sous Lion !   Mais Lion nest encore quun lionceau, il va nous falloir lui apprendre a marcher tout seul :D  
 V. Post Installation  Pour fonctionner tout seul, Lion va avoir besoin dun petit programme pour se lancer au boot (Chameleon) et de quelques drivers (kexts). Commencons par installer Extra Folder. Sur cette configuration, nous selectionnons MacPro3.1, qui correspond le mieux a notre systeme:   Veillez a bien selectionner votre disque dur pour linstallation, et non la cle Usb. Ensuite, installez Chameleon 2.0 RC5 (les precedentes versions ne savent pas gerer Lion):   La aussi, veillez a bien selectionner votre disque dur principal pour linstallation. Ensuite, copiez le fichier dsdt.aml dans le repertoire Extra a la racine de votre disque dur:   Lancez Kext Wizard, allez dans longlet Installation, et glissez y les kexts suivants, dabord dans le repertoire extra:   ensuite dans le repertoire extensions:   Histoire detre sur de ne pas avoir de probleme, allez ensuite sur longlet maintenance, puis lancez une reparation de toutes les permissions du disque:   Enfin, pour que la carte video 8400 soit correctement reconnue, nous allons editer le fichier com.apple.Boot.plist du repertoire Extra, et y ajouter les deux lignes en surbrillance:   Tant que nous sommes dans ce fichier, je conseillerai deux autres parametres a indiquer: pour ma part je ne veux pas avoir rien a faire au demarrage, donc je prefere demander a Chameleon de demarrer automatiquement la partition de Lion au bout de 5s. Jai donc ajoute ces deux parametres:  keyDefault Partition/key 
stringhd(0,2)/string 
keyTimeout/key 
string5/string  Sans cela, le demarrage restera bloque sur linterface de Chameleon, attendant que vous appuyez sur Entree pour selectionner la partition :/ Ici jindique le disque dur 0 (une fois la cle Usb de linstallation retiree, cest le disque dur ou est installe Lion qui devient le premier disque dur du systeme) et la partition 2 (la premiere, je le rappelle, etant une partition de restauration creee par Lion automatiquement). Voila, il ny a plus qua redemarrer, cette fois en enlevant la cle Usb: le systeme devrait demarrer correctement. Au redemarrage, la carte video devrait etre reconnue sans probleme, et savoir gerer jusquau 1920 (selon votre ecran, bien sur):   Le son devrait egalement fonctionner, il faudra peut etre simplement selectionner la bonne sortie (touche Alt + clic sur licone du son dans la barre des taches).   Enfin, le reseau devrait etre connecte. Bizarrement, la carte est affichee comme un Bluetooth PAN, mais le reseau fonctionne parfaitement, car le driver derriere est bien celui correspondant a notre carte Realtek, il sagit a priori juste dun probleme de nommage:   
 VI. Conclusion  Ce guide est certainement perfectible, si vous avez des remarques ou que vous decouvrez certaines astuces, nhesitez pas a nous en faire part en commentaire pour en faire profiter tout le monde. Pour ma part, en suivant ces etapes, mon Hackintosh fonctionne tres bien sous Lion 10.7 depuis 4 jours, sans probleme notable. Seule la mise en veille prolongee ne fonctionne pas, il faudra attendre quun fichier SleepEnabler.kext compatible soit rendu disponible. Jen ai teste plusieurs, mais chaque fois cela sest traduit par un plantage du systeme au redemarrage. Nutilisant pas la mise en veille prolongee, cela ne me pose pas de probleme. Mis a part cela, donc, le systeme est tres stable, lecran HD reconnu, avec le son, le reseau, et le bluetooth pour la Magic Mouse et le clavier Apple. Jai utilise ma sauvegarde Time Machine que javais sous Snow Leopard pour restaurer tous mes parametres et mes applications, et en un rien de temps jai retrouve une machine prete a travailler.    Personnellement, jaime beaucoup le nouveau systeme: avec les gestes tactiles sur la Magic Mouse, et le Dashboard facon iPad, je trouve cela vraiment tres agreable. Il y a quelques habitudes a reprendre (comme le defilement des pages de haut en bas qui est inverse par rapport a avant), mais possedant un iPad, je my suis fait tres rapidement. Ce petit permet davoir un systeme sous Mac, et de tenter une experience. Pour ma part, avec la sortie des nouveaux Mac Mini, qui commencent a 599, avec une configuration plutot puissante ( une petite comparaison entre mon hackintosh et le nouveau Mac mini premier prix, pour vous donner une idee ), ce nest plus quune question de temps avant que je ne passe a un vrai Mac :D Le Mac 27 ne sera pas pour tout de suite, mais le Mac Mini me permettra deja une tres bonne entree en matiere ;-) Pour ceux qui rencontreraient des difficultes, ou qui ne possederaient pas une configuration identique a la mienne, je vous invite a consulter  le site des kexts , qui contient de nombreux kexts pour tous les materiels, et  lexcellent forum InsanelyMac , ou vous trouverez certainement reponse a vos problemes.   Hackintosh   Lion 
        </text>
</document>
