<document>
	<date>2014-04-24</date>
        <title>Guide dutilisation du dtecteur de mouvement Fibaro FGMS-001 avec le Home Center 2 et Home Center Lite</title>
        <author> Bruno </author>
        <tags_set>
                <tag>detecteur de mouvement</tag>
                <tag>domotique</tag>
                <tag>fibaro</tag>
                <tag>guide</tag>
                <tag>hc2</tag>
                <tag>Home Center 2</tag>
                <tag>home center lite</tag>
                <tag>securite</tag>
                <tag>tuto</tag>
                <tag>z-wave</tag>
        </tags_set>
        <categories_set>
                <category>Z-Wave Applications</category>
        </categories_set>
        <text>
                                                         Le Home Center 2 et le Home Center Lite communiquent nativement en utilisant la technologie Z-Wave Fibaro Nous ne verrons que lintegration du module avec le Home Center 2. Pour plus dinformations sur linstallation, nous vous invitons a consulter notre  guide dutilisation du detecteur de mouvement Fibaro FGMS-001 1- Inclusion Rendez-vous sur linterface de votre controleur. Cliquez sur Modules (onglet disponible dans le menu situe en haut de votre interface). Cliquez ensuite sur Add or remove device situe a gauche de votre interface. Cliquez sur le bouton Ajouter dans la rubrique Ajouter un module pour inclure ce module (si votre module a deja ete inclus dans un autre reseau  Z-Wave Apres avoir clique sur Ajouter (dans la rubrique Ajouter un module), une nouvelle fenetre nommee Ajout des modules apparait avec un compte a rebours durant lequel vous devez appuyer3 fois brievement (en moins de 1,5 secondes) sur le bouton dapprentissage pour inclure ce module (si rien ne se passe, veuillez recommencer). Ce bouton dapprentissage est situea linterieur du detecteur. Une fois que votre module est detecte par votre Home Center 2, celui-ci va etre configure automatiquement et est disponible dans linterface de votre controleur dans la rubrique Modules . Vous pouvez desormais visualiser si il y a une detection de mouvement (ou tentative dalteration) ainsi que la temperature et luminosite mesurees. 2- Configuration Apres avoir correctement installe votre module, vous pouvez configurer ses parametres en cliquant sur licone cle a molette ou sur lidentifiant de votre module dans le menu Modules situe a gauche de votre interface. Dans la categorie General de votre module, vous pouvez indiquer son nom, la piece dans laquelle il se situe. Vous pouvez egalement visualiser les informations de ce module : genre, type de module, fabricant, version, configuration et ID. Dans la categorie Avance, vous pouvez visualiser et configurer des parametres supplementaires. Voici les parametres que vous pouvez configurer : Avance : Delai entre chaque interrogation : Vous pouvez definir un temps pour demander a ce dispositif si il est vivant plus frequemment que dans le reglage dun delai dinterrogation du  Z-Wave Z-Wave Ne pas marquer comme mort : Votre dispositif ne doit pas etre marque comme mort, meme si vous le desactivez. Use template for parameters :Utiliser ou non le modelepour les parametres. Save logs to Event Panel :Sauvegarder les journauxdans le panneaudevenements. Alarm settings : Vous pouvez exclure votre detecteur du systeme dalarme ou armer celui-ci avec un retard ou bien declencher lalarme apres un delai defini. Sensor arming conditions : Vous specifiez les conditions qui doivent etre remplies pour armer le detecteur. Cette fonction permet au detecteur de sarmer en fonction de letat dautres appareils (par exemple : si un volet est ferme). Minformer : Par  SMS SMS Par email : Vous etes informe par email pour toute action du module (allumage, extinction ou changement de statut). Par notification Push : Vous recevez une alerte dinformation sur lecran de votre tablette ou smartphone pour toute action du module (allumage, extinction ou changement de statut). Description du module : Associations : Configurer les valeurs par defaut : Vous pouvez configurer les valeurs par defaut. Reload parameters : Vous pouvez recharger les parametres. Configuration : Parametre 1 : Ce parametre definit la sensibilite du capteur PIR. Plus sa valeur est petite, plus le capteur PIR sera sensible. Parametre 2 :Temps pour lequel le capteur PIR sera  aveugle  aux mouvements. Ce parametre determine le temps minimum apres lequel le capteur PIR sera pret a detecter un nouveau mouvement. Plus ce temps est important, plus la vie de la batterie sera longue. Vous pouvez reduire cette valeur des que vous avez besoin que le capteur PIR detecte un mouvement plus rapidement. Le temps dinertie devrait etre plus petit que celui qui figure dans le parametre 6 (temps de maintien du mouvement). Parametre 3 : PULSE COUNTER  du capteur PIR.Definition du nombre de mouvements qu`il faudrait effectuer (en theorie) pour que le capteur PIR detecte le mouvement. Plus cette valeur est haute, moins le capteur PIR sera sensible. Il n`est pas recommande de modifier ce parametre. Parametre 4 : WINDOW TIME  du capteur PIR.Ce parametre determine le temps pendant lequel il doit y avoir un nombre de mouvements determine (parametre 3) pour que le capteur detecte le mouvement. Theoriquement plus cette valeur est grande, plus le capteur PIR est sensible (il nest pas recommande de modifier ce parametre). Parametre 6 : L`alarme du mouvement detectee sera retiree dans le controleur et les dispositifs associes apres le temps defini dans ce parametre. Chaque mouvement suivant fera prolonger ce temps et recommencer son calcul. Dans le cas de petites valeurs, de moins de 10 secondes, il faut corriger de maniere appropriee le parametre 2 (le parametre  Blind Time  du capteur PIR). Parametre 8 :Ce parametre definit les conditions de luminosite dans lesquelles fonctionnera le capteur PIR. Ce parametre influence uniquement les rapports de mouvement et les associations. Le capteur anti-sabotage, les mesures de la lumiere et de la temperature seront actives quelque soit la valeur de ce parametre. Parametre 9 :Ce parametre definit la limite du niveau de luminosite pour le parametre 8. Parametre 12 :Configuration des messages des classes de commande classiques  BASIC COMMAND CLASS .Ce parametre definit quels messages seront envoyes dans le premier groupe dassociation (lie avec le capteur PIR). Les valeurs des messages BASIC ON et BASIC OFF pourront etre modifiees avec les parametres appropries. Parametre 14 :Valeur du message de commande BASIC ON.La valeur 255 permet dactiver le dispositif. Dans le cas du module Dimmer (variateur) la valeur 255 signifie qu`il va passer sur son dernier etat memorise. Par exemple, si le Dimmer (variateur) etait a 30%, ensuite desactive puis reactive a l`aide de la commande 255, celui-ci s`activera sur son dernier etat, soit a 30%. Parametre 16 :Valeur du message de commande BASIC OFF.Ce message de commande est envoye au moment de l`annulation du mouvement apres le temps de maintien du mouvement defini par le parametre 6 (temps de maintien du mouvement). Parametre 20 : Ce parametre determine de combien doit changer la charge du capteur du mouvement pour que le capteur anti-sabotage notifie un sabotage. Cette unite est exprimee en fonction de lacceleration terrestre g. Parametre n22 :Temps passe apres lequel l`alarme du capteur anti-sabotage sera desactivee. Chaque nouvelle detection de sabotage ne prolongera pas le temps de maintien du capteur anti-sabotage. Parametre n24 :Ce parametre definit le comportement et le mode de notification du capteur anti-sabotage. Parametre n26 :Ce parametre determine si le message de detection dun sabotage du capteur anti-sabotage sera envoye dans le mode broadcast. Les messages broadcast peuvent etre recus par tous les dispositifs a sa portee (sils le permettent). Parametre n40 :Ce parametre determine de combien devra changer la luminosite par rapport a la derniere valeur notifiee pour que cette nouvelle valeur soit egalement notifiee au controleur. Parametre n42 : Ce parametre determine l`intervalle entre les envois des rapports successifs de luminosite. Ces rapports sont envoyes meme s`il n`y a pas eu de changement de luminosite. Parametre n60 : Ce parametre determine de combien devra changer la temperature par rapport a la derniere valeur notifiee pour que cette nouvelle valeur soit egalement notifiee au controleur. Parametre n62 : Ce parametre determine la frequence de mesures. Plus la duree entre les mesures sera courte, plus la temperature sera mesuree frequemment au detriment de la duree de vie de la batterie. Parametre n64 : Ce parametre determine la frequence des rapports de temperature envoyes au controleur. Parametre n66 : Cest la valeur qui sera ajoutee a celle de la temperature reellement mesuree. Parametre n80 :Ce parametre determine le type dallumage de la LED apres avoir detecte un mouvement. Valeurs 1 a 9  Clignotement prolonge au moment de l`envoi du rapport dune detection. Aucun autre mouvement ne sera indique jusqua ce que lalarme soit annulee. Valeurs 10 a 18  Clignotement prolonge au moment de l`envoi du rapport dune detection et clignotement court a chaque fois quun nouveau mouvement est detecte. Valeurs 19 a 26  Clignotement prolonge au moment de l`envoi du rapport dune detection et deux clignotements courts des la detection dun autre mouvement. Parametre n81 :Ce parametre determine la luminosite de la LED apres avoir detecte le mouvement.0 signifie que la luminosite dependra de l`eclairage du local  voir parametres 82 et 83. Parametre n82 : Niveau declairage du local/alentours au dessous duquel la LED sallumera au niveau de 1% de sa luminosite maximale. Ce parametre est important seulement quand le parametre 81 (luminosite de la LED) a ete configure de maniere adequate. Parametre n83 :Niveau declairage du local/alentours au dessous duquel la LED sallumera au niveau de 100% de sa luminosite maximale. Ce parametre est important seulement quand le parametre 81 (luminosite de la LED) a ete configure de maniere adequate. Parametre n86 :Temperature minimale pour lillumination de la LED en bleu.  Ce parametre est important seulement quand le parametre 80 (signalisation de la detection du mouvement) a ete configure de maniere adequate. Plage de valeurs : 0 jusqu`a la valeur du parametre 87 (0  255 C). Parametre n87 :Temperature maximale pour lillumination de la LED en rouge.Ce parametre est important seulement quand le parametre 80 (signalisation de la detection du mouvement) a ete configure de maniere adequate. Plage de valeurs : valeur du parametre 86 jusqu`a 255 ( 1  255 C) Parametre n89 :Signalisation de detection du capteur anti-sabotage avec LED allumee.Cette signalisation rappelle celle dune voiture de patrouille de la police 3- Exemple de scene Votre imagination est la seule limite pour creer une scene. Nous vous presentons dans cet article un premier exemple de scene en utilisant la methode blocs graphiques et un second exemple de scene en utilisant la programmation en LUA. Vous devez en premier lieu vous rendre dans la rubrique Scenes situe en haut, dans le menu de votre interface puis cliquezsur Ajouter dans la rubrique Ajouter une scene. Dans General, vous pouvez configurer le nom de la scene et la piece dans laquelle elle se situe, loption dafficher ou non la scene dans linterface, la commande vocale pour mettre en marche ou arret la scene (option uniquement disponible sur le Home Center 2), une option dactivation de la scene, que celle-ci se lance lors du demarrage du Home Center 2 ou Home Center Lite, la proteger avec mot de passe et permettre ou non a une alarme qui senclenche darreter la scene. Rendez-vous ensuite dans la rubrique Avance. Vous pouvez creer votre scene en choisissant lune des deux options : blocs graphiques ou LUA. 3.1- Blocs graphiques(Home Center 2 et Home Center Lite) Pour creer une scene en utilisant la methode des blocs graphiques, cliquez sur Ajouter dans Ajouter une scene en utilisant les blocs graphiques. Cliquez ensuite sur le bouton +. Un menu apparait pour choisir vos elements. Lorsque vous selectionnez un element (exemple : module), un bouton condition est disponible et vous devez choisir parmi les options suivantes : Et, Ou, Alors. Voici un exemple de scene : Si mon detecteur de mouvement FGMS-001 est arme et detecte un mouvement, alors ma sirene sactive et je recois une notification PUSH sur mon smartphone avec le message Intrusion detectee chez vous. Veuillez noter que loption  Detecteur mouvement  dans Triggering device est cochee. Cela signifie que votre scene senclenche automatiquement des la detection dun mouvement (ou sabotage). Pour sauvegarder votre scene, cliquez sur Sauver. Pour plus dinformations sur lutilisation des notifications PUSH, decouvrez notre  guide de creation de notification PUSH avec le Home Center 2 3.2- Programmation LUA (Home Center 2 uniquement) Pour creer une scene en utilisant la methode LUA, cliquez sur Ajouter dans Ajouter une scene en LUA. Vous pouvez desormais ecrire votre scene en langage LUA. Voici un exemple de scene : Si mon detecteur de mouvement FGMS-001 detecte un mouvement, alors mon eclairage se met sur ON durant 5 minutes puis seteint. Etape 1 : Nous devons connaitre les numeros identifiants des modules (ID) :  Detecteur de mouvement FGMS-001 :  755  Interrupteur ON/OFF :  753 (Pour retrouver vos numeros identifiants des modules, accedez a la rubrique Modules dans votre interface puis cliquez sur loutil en forme de cle a molette sur votre module. Vous etes ensuite sur la rubrique General de votre module et pouvez visualiser son numero ID). Etape 2 : Votre scene en langage LUA doit toujours commencer avec l entete --[[
 %% properties

%% globals
 --]] (Celle-ci est deja mise en place automatiquement dans votre interface). Etape 3 : Etant donne que nous voulons un declenchement automatique, nous devons utiliser la fonction Trigger IF THEN Call Sleep ID  Pour letat du detecteur de mouvement, la valeur  1 detection de mouvement  0 aucune detection de mouvement   Une action secrit : fibaro (device ID, action Name) 753 turnOn  Pour la temporisation, la valeur indiquee est en ms. Pour un eclairage dune duree de 5 minutes, cela correspond a 300 secondes soit  300 000  Pour finir, il faut indiquer le mot  end Voici notre scene complete : 
--[[
%% properties

755 value

%% globals
--]]

local DetecteurMouvement

DetecteurMouvement = fibaro:getValue(755, 'value' )

if (DetecteurMouvement == '1') then

fibaro:call(753, 'turnOn')

fibaro:sleep(300000)

fibaro:call(753, 'turnOff')

end
 Attention : pour la programmation en LUA, vous devez bien respecter la syntaxe car votre scene ne pourra fonctionner si il y a une faute de signe, chiffre ou lettre. Vous pouvez bien evidemment creer une infinite de scenes en utilisant ce detecteurde mouvement FGMS-001 (desactiver un eclairage apres une certaine duree de non detection de mouvement, activer un convecteur lors dune detection de mouvement etc). Pour plus dinformations sur la creation de scenes, rendez-vous sur notre article :  Creation de scenarios (blocs graphiques et LUA) avec le Home Center 2  Simple Share Buttons Adder (5.6) simplesharebuttons.com  
 Ces sujets pourraient vous interesser aussi: Aucune proposition. END .entry-content  
        </text>
</document>
